<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Thesis Proof Of Concept</title>
    <style>
      body { margin: 0 }
    </style>
    <link rel="icon" href="resources/icon.svg"/>
  </head>
  <body>
    <script type="module" src="/main.js"></script>
    <script id="vertexShader" type="x-shader/x-vertex">
      varying vec2 vUv;
      varying vec3 vPosition;
      varying vec3 vNormal;

      void main() {
          vUv = uv;
          vPosition = vec3(position.x,position.y,position.z+sin(position.y));
          vNormal = normal;
          gl_Position = projectionMatrix * modelViewMatrix * vec4(vPosition, 1.0);
      }
    </script>
    <script id="fragmentShader" type="x-shader/x-fragment">
      uniform vec3 uCamera;      
      uniform sampler2D uTexture;

      varying vec2 vUv;      
      varying vec3 vPosition;
      varying vec3 vNormal;

      const vec3 lightColor = vec3(1.0,0.0,0.0);
      const vec3 lightPosition = vec3(0.0,0.0,5.0);

      const float lightIntensity = 0.20;
      const float ambientLightIntensity = 0.50;
      const float specularIntensity = 0.5;

      void main() {
        vec3 normal = normalize(vNormal);
        vec3 viewDir = normalize(uCamera-vPosition);
        vec3 toLight = lightPosition - vPosition; 
        vec3 lightDir = normalize(toLight);

        float distToLight = length(toLight);
        float intensityInSurface = lightIntensity * max(dot(normal, lightDir),0.0);
        float diffused = intensityInSurface / (1.0+distToLight*distToLight);

        float ambient = ambientLightIntensity;

        vec3 reflection = reflect(lightDir, normal);
        float shine = 32.0;
        float specular = specularIntensity * pow(max(dot(viewDir,reflection), 0.0), shine);

        vec3 texColor = texture2D(uTexture,vUv).rgb; 
        vec3 finalColor = texColor * (ambient + diffused);
        gl_FragColor = vec4(finalColor,1.0);
      } 
    </script>
  </body>
</html>